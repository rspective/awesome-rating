$.fn.awesomeRating=function(a){a=a||{};var b={values:[1,2,3,4,5],valueInitial:null,cssBase:"rating-star fa",cssBaseSelected:"fa-star",cssBaseUnselected:"fa-star-o",cssValuesSelected:["first-selected","second-selected","third-selected","forth-selected","fifth-selected"],cssValuesUnselected:["first-unselected","second-unselected","third-unselected","forth-unselected","fifth-unselected"],targetSelector:null,htmlBase:"<i></i>",htmlSelector:":last-child",htmlEvent:"click"};return this.each(function(){if(!this._awesomeRatingApi){var c=$(this),d={values:{list:a.values||b.values||[],initial:a.valueInitial||b.valueInitial||null,current:null},html:{base:a.htmlBase||b.htmlBase,selector:a.htmlSelector||b.htmlSelector,event:a.htmlEvent||b.htmlEvent},css:{base:a.cssBase||b.cssBase,selected:a.cssBaseSelected||b.cssBaseSelected,unselected:a.cssBaseUnselected||b.cssBaseUnselected,values:{selected:a.cssValuesSelected||b.cssValuesSelected||[],unselected:a.cssValuesUnselected||b.cssValuesUnselected||[]}},external:{$:{element:c,target:$(a.targetSelector||b.targetSelector),rates:null},val:function(a){return void 0===a?d.values.current:(d.storeValue(a),void d.updateCss())}},temp:{$initial:null},storeValue:function(a){d.values.current=a,d.external.$.target&&d.external.$.target.text(a)&&d.external.$.target.val(a),d.triggerEvent()},updateCss:function(){var a=!1||null==d.values.current;d.external.$.rates.each(function(b){var c=$(this);c.toggleClass(d.css.selected,!a),c.toggleClass(d.css.unselected,a),d.css.values.selected.length==d.values.list.length&&d.css.values.selected.length==d.values.list.length&&$.each(d.values.list,function(b,e){c.toggleClass(d.css.values.selected[b],!a&&e===d.values.current),c.toggleClass(d.css.values.unselected[b],a&&e===d.values.current)}),d.values.list[b]===d.values.current&&(a=!0)})},triggerEvent:function(){d.external.$.element.trigger("rated",[d.values.current])}};$.each(d.values.list,function(a,b){var c=d.external.$.element.append(d.html.base).find(d.html.selector);c.toggleClass(d.css.base,!0),c.toggleClass(d.css.unselected,!0),c.on(d.html.event,function(){b!=d.values.current&&(d.storeValue(b),d.updateCss(c))}),b==d.values.initial&&(d.temp.$initial=c)}),d.external.$.rates=d.external.$.element.children(),d.temp.$initial&&d.temp.$initial.trigger(d.html.event),this._awesomeRatingApi=d.external}})},angular.module("awesome-rating",[]).directive("awesomeRating",function(a){return{restrict:"A",scope:{awesomeRating:"=",awesomeRatingOptions:"@"},link:function(b,c){var d=b.awesomeRatingOptions&&JSON.parse(b.awesomeRatingOptions)||{};d.valueInitial=b.awesomeRating,$element=$(c).awesomeRating(d).on("rated",function(c,d){a(function(){b.awesomeRating=d})}),b.$watch("awesomeRating",function(a){$element.each(function(){this._awesomeRatingApi.val(a)})})}}});